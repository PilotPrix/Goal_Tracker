<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="HandheldFriendly" content="true">
	<title>JamHacks</title>
	<link rel="icon" href="logo.png">
	<link rel="stylesheet" type="text/css" href="styles.css">
	<link href="action_page.php">
	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300&display=swap" rel="stylesheet">
	<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
</head>
<body>
	<script>
		AOS.init();
		AOS.init({
		duration: 1000,
		offset: 120,
		throttleDelay: 200,
		});
	</script>

	<div class="container">
		<h1 class="center">Goal Tracker and Milestone Setter</h1>
		<button onclick="show3()" class="header_button">Set My Goal</button>
		<button onclick="show4()" class="header_button">Learn More</button>
	</div>	
	<div id="about">
		<h2>About this application:</h2>
		<p >This web application helps its users set and manage their goals. Users can split their goal into different stages which will then be converted into milestones. In addition, this application has other usefull features, such as progress calculator and amount of time left until goal completion. All these features are supposed to help the users become more productive and achieve their goals better</p>
	</div>
	<div id="goals">
				<h4>What is your goal?</h4>
				<input type="text" name="goal" class="start" placeholder="Type in your Goal"/>
				<h4>Split your goal into different stages?</h4>

			<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
			<input type="text"  class="start" name="goal" placeholder="Type in your goal stage">
			
				<input type="date" class="start2" id="date_in0" name="start"/>

		    <button onclick="addLine()" class="add_button">Add</button>
		    <div id="new_space"></div>

		    <input type="hidden" class="start" value="1" id="new_line" placeholder="Type in your goal stage">
		    <br><br>
			<input type="checkbox" class="checkb">I would like to receive notifications on my milestones</checkbox><br>
	</div>

	<script>
		function show3() {
			var section = document.getElementById("goals");
				if (section.style.display === "none"){
					section.style.display = "block";
				} else {
					section.style.display = "none";
				}
		}
		function show4() {
			var section_two = document.getElementById("about");
				if (section_two.style.display === "none"){
					section_two.style.display = "block";
				} else {
					section_two.style.display = "none";
				}
		}

		var index = 0;

		function addLine(){
			index++;

			var new_chq_no = parseInt($('#new_line').val())+1;
			var new_input="<input type='text'class='start' placeholder='Type in your goal stage'id='new_"+new_chq_no+"'><input type='date' id='date_in' class='start2'/><button onclick='addLine()'class='add_button'>Add</button> <br>";

			$('#new_space').append(new_input);
			$('#new_line').val(new_chq_no);
			document.getElementById('date_in').id = "date_in" + index;

		function dateVar() {
			var input = document.getElementById("date_in" + (index - 1).toString()).value;
			console.log(input);
			var input_text = document.getElementById('new_line')
  	};
  	dateVar();
  };
	</script>
		<div class="buttons">
			<button id="calculate" class="add_button" onclick="show()">Amount of Days Left</button>
			<button id="calculate" class="add_button" onclick="showTwo()">Progress</button>
			<button id="calculate" class="add_button" onclick="order()">Milestone Timeline</button>
		<div/>
<!-- Amount of days left in order to achieve each stage of the goal-->
		<div class="results">
			<p id="remainingTime"></p>
		</div>

<!-- Putting goal stages in order from the earliest to the latest--> 
	<div id="timeline_section">
		<h2>The timeline of your milestones:</h2>
		<span id="timeline"></span>
	</div>

<!-- Calculating the user's progress-->
<div id="results">
	<h3>How much did you plan to do?</h3>
	<input type="text" id="text_one" class="start2" placeholder="Type in the number of things you accomplished"/>
	<h3>How much did you do?</h3>
	<input type="text" id="text_two" class="start2" placeholder="Type in the number of things you accomplished"/>
	<button onclick="calculateProgress()" class="add_button">Calculate</button>
	<h3>Your Overall Progress: <span id="progress"></span></h3>
</div>

<script>
			function showTwo(){
				var y = document.getElementById("results");
				if (y.style.display === "none"){
					y.style.display = "block";
				} else {
					y.style.display = "none";
				}
			}
		</script>
		<script>
			var dates_list = [];
			function order(){
				i = 0;
				while(true){
					// check if date_in i "eg. date_in5" exists
					if(document.getElementById("date_in" + i)){
						// save date to dates_list
						var date = document.getElementById("date_in" + i).value
						dates_list[i] = date;
					}
					// if date_in i doesn't exist, break
					else{
						break;
					}
					i++;
				}
				var time = document.getElementById("timeline_section");
				if (time.style.display === "none"){
					time.style.display = "block";
				} else {
					time.style.display = "none";
				}
				console.log(dates_list);
				document.getElementById('timeline').innerHTML = dates_list;
				var goal_input = document.getElementById()

				// var sorted = sort(dates_list);
				// console.log(sorted);
				// import moment from 'moment'
				// const sortDates = (a, b) => 
				// moment(a.roomtypedate).format('YYYYMMDD') - 
				// moment(b.roomtypedate).format('YYYYMMDD')

				// const sortedDates = dates_list.sort(sortDates)
				// console.log(sortedDates);
			};
			function calculateProgress() {
				var expectation = document.getElementById("text_one").value;
				var result = document.getElementById("text_two").value;

				console.log(expectation);
				console.log(result);

				function calculate(){
					var progress = (result / expectation) * 100;
					// var progress_t = (result / expectation) * 100 + "%";
					var p = progress.toFixed(0);			
					console.log(p + "%");
					document.getElementById('progress').innerHTML = p + "%";
				};
			calculate();
		}
		</script>

		<script>
			function show(){
				var x = document.getElementById("remainingTime");
				if (x.style.display === "none"){
					x.style.display = "block";
				} else {
					x.style.display = "none";
				}
			}


			function refreshTimer(){
			  function countDown(){
			    setTimeout(function(now){
                 var dif = (td-now)/1000,
                      ss = Math.floor(dif % 60).toString().padStart(2,"0"),
                      ms = Math.floor(dif/60 % 60).toString().padStart(2,"0"),
                      hs = Math.floor(dif/3600 % 24).toString().padStart(2,"0"),
                      ds = Math.floor(dif/86400).toString().padStart(3,"0");
                  remainingTime.textContent = dif > 0 ? `${ds} Days ${hs}:${ms}:${ss}`
                                                      : "Sorry. You are already late..!";
                  active && countDown();
                  this.removeEventListener("change", kill); // possibly redundant
                }, 1000, Date.now());
  }
			  var td     = new Date(this.value),
			      active = true,
			      kill   = _ => active = false;
			  this.addEventListener("change", kill);
			  countDown();
			}

			var targetDateTime = document.getElementById("date_in"),
			    remainingTime  = document.getElementById("remainingTime");

			targetDateTime.addEventListener("change",refreshTimer);

		</script>

</body>
